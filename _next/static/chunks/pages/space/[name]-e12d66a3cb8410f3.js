(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[187],{98798:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/space/[name]",function(){return t(14983)}])},14983:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Z}});var r=t(34051),a=t.n(r),s=t(85893),o=t(67294),c=t(11163),i=t(15638),u=t(58529),l=t(39642),d=t(19600),p=t(51768),f=t(48297),m=t(40782),h=t(30908),v=t(61149),b=t(93463),x=t(87536);function y(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function j(e,n,t,r,a,s,o){try{var c=e[s](o),i=c.value}catch(u){return void t(u)}c.done?n(i):Promise.resolve(i).then(r,a)}function w(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var s=e.apply(n,t);function o(e){j(s,r,a,o,c,"next",e)}function c(e){j(s,r,a,o,c,"throw",e)}o(void 0)}))}}function g(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){g(e,n,t[n])}))}return e}function S(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,s=[],o=!0,c=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(s.push(r.value),!n||s.length!==n);o=!0);}catch(i){c=!0,a=i}finally{try{o||null==t.return||t.return()}finally{if(c)throw a}}return s}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return y(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return y(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=function(e){var n,t=e.spaceId,r=e.name,c=e.description,i=e.blacklistedUsers,l=e.setBlacklist,y=e.showDialog,j=e.onClose,g=S(o.useState(!1),2),k=g[0],D=g[1],I=(0,u.ZP)((function(e){return{contract:e.contract}})).contract,A=(0,x.cI)(),C=A.register,O=A.handleSubmit,P=A.setError,H=A.formState.errors,T=function(){var e=w(a().mark((function e(n){var r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D(!0),r=n.description,console.log(r),r===c){e.next=8;break}return e.next=6,(0,p.Xr)(I,t,r);case 6:(s=e.sent).success?(D(!1),j()):(D(!1),P("description",{type:"manual",message:"".concat(s.error)},{shouldFocus:!0}));case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),E=function(){var e=w(a().mark((function e(n){var r,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.EV)(I,t,n);case 2:(r=e.sent).success?(m.Am.success("User has access again!",{autoClose:3e3}),s=i.filter((function(e){return e.userId!==n})),l(s)):m.Am.error("".concat(r.error),{autoClose:3e3});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),L=i.map((function(e){return(0,s.jsxs)(v.Z,{children:[e.username,(0,s.jsx)("button",{type:"button",onClick:function(){E(e.userId)},children:(0,s.jsx)(h.Z,{icon:"faTimes",className:"ml-2 text-red-500"})})]})}));return(0,s.jsx)(f.Z,{showDialog:y,onClose:j,header:"Space Settings",body:(0,s.jsxs)("form",{id:"spaceSettingsForm",onSubmit:O(T),children:[(0,s.jsxs)("div",{className:d.o.inputWrapper,children:[(0,s.jsx)("span",{className:"\n                ".concat(d.o.inputLabel,"\n                ").concat(d.o.inputLabelDark,"\n              "),children:"Name"}),(0,s.jsx)("input",{className:"\n                ".concat(d.o.input,"\n                ").concat(d.o.inputDefault,"\n                ").concat(d.o.inputDefaultDark,"\n                ").concat(d.o.inputFocus,"\n              "),type:"text",disabled:!0,defaultValue:r})]}),(0,s.jsxs)("div",{className:d.o.inputWrapper,children:[(0,s.jsx)(b.Z,N({minRows:2,maxLength:280,defaultValue:c,className:"\n              ".concat(d.o.form,"\n              ").concat(d.o.input,"\n              ").concat(d.o.inputDefault,"\n              ").concat(d.o.inputDefaultDark,"\n              ").concat(d.o.inputFocus,"\n              ").concat(d.o.inputPlaceholder,"\n              ").concat(d.o.inputPlaceholderDark,"\n          ")},C("description",{required:!0}))),H.description&&(0,s.jsx)("div",{className:"".concat(d.o.formValidation," ").concat(d.o.formValidationError),children:(0,s.jsx)("span",{className:"".concat(d.o.formValidationText," ").concat(d.o.formValidationTextError),children:"required"===(null===(n=H.description)||void 0===n?void 0:n.type)&&"Please fill out the description"})})]}),(0,s.jsxs)("div",{className:d.o.inputWrapper,children:[(0,s.jsxs)("span",{className:"\n                ".concat(d.o.inputLabel,"\n                ").concat(d.o.inputLabelDark,"\n              "),children:["Blacklisted User ",L.length>0&&"(".concat(L.length,")")]}),(0,s.jsxs)("div",{className:d.o.tagListRow,children:[L.length>0&&L,0===L.length&&(0,s.jsx)("p",{children:"No users on the blacklist"})]})]})]}),footer:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{type:"button",className:"\n              ".concat(d.o.button,"\n              ").concat(d.o.buttonTransparent,"\n              ").concat(d.o.buttonTransparentDark,"\n              ").concat(d.o.buttonFull,"\n            "),onClick:function(){return j()},children:"Cancel"}),(0,s.jsx)("button",{type:"submit",form:"spaceSettingsForm",className:"\n              ".concat(d.o.button,"\n              ").concat(d.o.buttonDecensored,"\n              ").concat(d.o.buttonFull,"\n            "),children:(0,s.jsxs)("span",{className:"whitespace-nowrap",children:["Save ",k&&(0,s.jsx)(h.Z,{icon:"faSpinner",className:"ml-2 animate-spin"})]})})]})})},D=t(41664),I=t.n(D),A=function(e){var n=e.showDialog,t=e.onClose,r=e.users.map((function(e){return(0,s.jsxs)("div",{className:"".concat(d.o.itemListItem," ").concat(d.o.itemListItemDark),children:[e.username,(0,s.jsx)(I(),{href:"/user/".concat(e.username),passHref:!0,children:(0,s.jsx)("a",{href:"passed",children:(0,s.jsx)(v.Z,{clickable:!0,classNames:d.o.itemListItemHoverElement,children:(0,s.jsxs)("span",{children:[(0,s.jsx)("span",{className:"hidden sm:inline",children:"Open "}),"Profile"]})})})})]},"user-".concat(e.id))}));return(0,s.jsx)(f.Z,{showDialog:n,onClose:t,header:"Space Users",body:(0,s.jsx)("form",{id:"spaceSettingsForm",children:(0,s.jsx)("div",{className:"".concat(d.o.itemList," ").concat(d.o.itemListDark),children:r})}),footer:(0,s.jsx)("button",{type:"button",className:"\n            ".concat(d.o.button,"\n            ").concat(d.o.buttonTransparent,"\n            ").concat(d.o.buttonTransparentDark,"\n            ").concat(d.o.buttonFull,"\n          "),onClick:function(){return t()},children:"Close"})})},C=function(e){var n=e.space,t=e.spaceOwner,r=e.spaceOwnerName,a=e.name,c=e.nrOfPosts,i=e.nrOfUSers,u=e.userArray,l=e.blackListArray,p=e.setBlackListArray,f=(0,o.useState)(!1),m=f[0],b=f[1],x=(0,o.useState)(!1),y=x[0],j=x[1];return(0,s.jsxs)("div",{className:"".concat(d.o.spaceHeaderWrapper," bg-gradient"),children:[t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{icon:"faCog",className:"absolute top-3 right-3 cursor-pointer text-white",onClick:function(){return b(!0)}}),(0,s.jsx)(k,{spaceId:n.id,name:n.name,description:n.description,blacklistedUsers:l,setBlacklist:p,showDialog:m,onClose:function(){return b(!1)}})]}),(0,s.jsxs)("div",{className:d.o.spaceHeaderInner,children:[(0,s.jsxs)("div",{className:d.o.spaceHeaderInnerCol1,children:[(0,s.jsxs)("div",{className:d.o.spaceHeaderTitle,children:["/",a]}),(0,s.jsx)("div",{className:d.o.spaceHeaderDescription,children:n.description}),(0,s.jsx)("div",{className:d.o.spaceHeaderDescription,children:(0,s.jsx)(I(),{href:"/user/".concat(r),passHref:!0,children:(0,s.jsx)("a",{href:"passed",children:(0,s.jsx)(v.Z,{clickable:!0,children:(0,s.jsxs)("span",{children:["@",r]})})})})})]}),(0,s.jsx)("div",{className:d.o.spaceHeaderInnerCol2,children:(0,s.jsxs)("div",{className:d.o.spaceHeaderDataWrapper,children:[(0,s.jsxs)("div",{className:d.o.spaceHeaderDataCol,children:[(0,s.jsx)("span",{className:d.o.spaceHeaderDataTitle,children:c}),(0,s.jsx)("span",{className:d.o.spaceHeaderDataText,children:"Posts"})]}),(0,s.jsxs)("div",{className:d.o.spaceHeaderDataCol,children:[(0,s.jsx)("button",{type:"button",onClick:function(){j(!0)},className:d.o.spaceHeaderDataTitle,children:i}),(0,s.jsx)("span",{className:d.o.spaceHeaderDataText,children:"Followers"}),(0,s.jsx)(A,{users:u,showDialog:y,onClose:function(){return j(!1)}})]})]})})]})]})},O=t(72657);function P(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function H(e,n,t,r,a,s,o){try{var c=e[s](o),i=c.value}catch(u){return void t(u)}c.done?n(i):Promise.resolve(i).then(r,a)}function T(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,s=[],o=!0,c=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(s.push(r.value),!n||s.length!==n);o=!0);}catch(i){c=!0,a=i}finally{try{o||null==t.return||t.return()}finally{if(c)throw a}}return s}}(e,n)||L(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e){return function(e){if(Array.isArray(e))return P(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||L(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,n){if(e){if("string"===typeof e)return P(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?P(e,n):void 0}}var Z=function(){var e=(0,c.useRouter)().query.name,n=(0,u.ZP)((function(e){return{accounts:e.accounts,spaces:e.spaces,posts:e.posts,currentUserId:e.userId,contract:e.contract}})),t=n.accounts,r=n.spaces,f=n.posts,m=n.currentUserId,h=n.contract,v=T(o.useState(!1),2),b=v[0],x=v[1],y=T(o.useState(""),2),j=y[0],w=y[1],g=T(o.useState(),2),N=g[0],S=g[1],k=T(o.useState([]),2),D=k[0],I=k[1],A=T(o.useState(0),2),P=A[0],L=A[1],Z=T(o.useState(0),2),F=Z[0],_=Z[1],U=T(o.useState([]),2),V=U[0],B=U[1],W=T(o.useState(!1),2),q=W[0],M=W[1],R=T(o.useState([]),2),X=R[0],$=R[1];o.useEffect((function(){if((0,l.eI)(h)&&e&&r.length){var n=(0,l.PP)(r,e),s=(0,l.NL)(r,n);S(s);var o=(0,l.GA)(t,s.owner);w(o.username);var c=(0,l.q)(f,s);I(c),L(c.length),m===s.owner&&x(!0);var i=E(new Map(c.map((function(e){return[e.username,{userId:e.author,username:e.username}]}))).values());_(i.length),B(i);var u=[];i.forEach(function(){var e,t=(e=a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.DY)(h,n,t.userId);case 2:e.sent&&(u.push(t),t.userId===m&&M(!0));case 4:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,a){var s=e.apply(n,t);function o(e){H(s,r,a,o,c,"next",e)}function c(e){H(s,r,a,o,c,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}()),$(u)}}),[h,e,f,r,m,q,t,j]);var G=D.map((function(e){if(0!==e.mother_post)return null;var n=X.filter((function(n){return n.userId===e.author})).length>0;return(0,s.jsx)(i.Z,{moderator:b,blacklist:X,authorIsBlacklisted:n,post:e,type:"space",parent:!0},"post-".concat(e.id))}));return N?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.Z,{title:"".concat(N.name," by ").concat(j),description:N.description}),(0,s.jsxs)("div",{className:d.o.feedWrapper,children:[(0,s.jsx)(C,{space:N,spaceOwner:b,spaceOwnerName:j,name:e,nrOfPosts:P,nrOfUSers:F,userArray:V,blackListArray:X,setBlackListArray:$}),G]})]}):(0,s.jsx)(O.Z,{})}}},function(e){e.O(0,[240,60,774,888,179],(function(){return n=98798,e(e.s=n);var n}));var n=e.O();_N_E=n}]);